# 移动端侧边栏导航实现

## 任务概述
为移动端添加汉堡菜单和侧边栏展开功能，解决移动端用户无法访问导航菜单的问题。

## 实现方案

### 设计理念
- **移动端优先**：专门为移动端设计的导航体验
- **抽屉式展开**：从左侧滑出的侧边栏，符合移动端交互习惯
- **一致性**：与桌面端导航菜单保持内容一致
- **可访问性**：支持键盘操作和屏幕阅读器

## 实现细节

### 1. 顶部导航栏修改

**文件**：`app/home/layout.tsx`

**主要修改**：
```tsx
{/* Logo */}
<div className="navbar-start">
    {/* 移动端汉堡菜单按钮 */}
    <MobileSidebar />
    
    <div className="flex items-center justify-center gap-2 ml-2 lg:ml-0">
        <span className="text-xl">🎭</span>
        <h1 className="text-xl font-bold text-primary hidden sm:block">TMDB</h1>
    </div>
</div>
```

**关键特性**：
- 添加 `MobileSidebar` 组件到 navbar-start
- 调整 Logo 区域的边距，为汉堡菜单留出空间
- 保持桌面端布局不变

### 2. MobileSidebar 组件实现

**文件**：`app/components/layout/MobileSidebar.tsx`

**核心功能**：

#### 汉堡菜单按钮
```tsx
<button
  onClick={() => setIsOpen(true)}
  className="btn btn-ghost btn-circle lg:hidden"
  aria-label="打开导航菜单"
>
  <Bars3Icon className="w-6 h-6" />
</button>
```

**特性**：
- 只在移动端显示 (`lg:hidden`)
- 使用 DaisyUI 的圆形按钮样式
- 添加无障碍标签

#### 侧边栏抽屉
```tsx
{isOpen && (
  <div className="fixed inset-0 z-50 lg:hidden">
    {/* 遮罩层 */}
    <div 
      className="fixed inset-0 bg-black/50 backdrop-blur-sm"
      onClick={() => setIsOpen(false)}
      aria-hidden="true"
    />
    
    {/* 侧边栏内容 */}
    <div className="fixed left-0 top-0 h-full w-80 max-w-[80vw] bg-base-100 shadow-xl transform transition-transform duration-300 ease-in-out">
      {/* 侧边栏内容 */}
    </div>
  </div>
)}
```

**关键特性**：
- **全屏遮罩**：`fixed inset-0` 覆盖整个屏幕
- **毛玻璃效果**：`backdrop-blur-sm` 增加视觉层次
- **响应式宽度**：`w-80 max-w-[80vw]` 适配不同屏幕
- **平滑动画**：`transition-transform duration-300 ease-in-out`
- **高层级**：`z-50` 确保在最顶层

#### 侧边栏头部
```tsx
<div className="flex items-center justify-between p-4 border-b border-base-300">
  <div className="flex items-center gap-2">
    <span className="text-2xl">🎭</span>
    <h2 className="text-xl font-bold text-primary">TMDB</h2>
  </div>
  <button
    onClick={() => setIsOpen(false)}
    className="btn btn-ghost btn-sm btn-circle"
    aria-label="关闭导航菜单"
  >
    <XMarkIcon className="w-5 h-5" />
  </button>
</div>
```

**特性**：
- 显示应用 Logo 和名称
- 右侧关闭按钮
- 底部边框分隔

#### 导航菜单
```tsx
<nav className="p-4">
  <ul className="menu w-full text-base-content space-y-2">
    {MENU_ITEMS.map((item: MenuItem) => {
      const IconComponent = item.icon;
      const isActive = isActivePath(item.path);
      
      return (
        <li key={item.path}>
          <Link
            href={item.path}
            onClick={handleMenuClick}
            className={`${
              isActive ? 'active bg-primary/10 text-primary' : ''
            } py-3 text-base font-medium rounded-lg hover:bg-base-200 transition-colors`}
          >
            <IconComponent className="w-5 h-5" />
            {t(item.key as any)}
          </Link>
        </li>
      );
    })}
  </ul>
</nav>
```

**特性**：
- 使用与桌面端相同的 `MENU_ITEMS` 数据
- 激活状态高亮显示
- 点击后自动关闭侧边栏
- 悬停效果和过渡动画

#### 侧边栏底部
```tsx
<div className="absolute bottom-0 left-0 right-0 p-4 border-t border-base-300 bg-base-100">
  <div className="text-center text-sm text-base-content/60">
    <p>TMDB 电影数据库</p>
    <p className="text-xs mt-1">探索精彩影视世界</p>
  </div>
</div>
```

**特性**：
- 固定在底部
- 显示应用信息
- 增加品牌感

### 3. 交互体验优化

#### 键盘支持
```tsx
useEffect(() => {
  const handleKeyDown = (event: KeyboardEvent) => {
    if (event.key === 'Escape' && isOpen) {
      setIsOpen(false);
    }
  };

  if (isOpen) {
    document.addEventListener('keydown', handleKeyDown);
    // 防止背景滚动
    document.body.style.overflow = 'hidden';
  } else {
    document.body.style.overflow = 'unset';
  }

  return () => {
    document.removeEventListener('keydown', handleKeyDown);
    document.body.style.overflow = 'unset';
  };
}, [isOpen]);
```

**特性**：
- **ESC 键关闭**：支持键盘操作
- **防止背景滚动**：侧边栏打开时锁定背景
- **清理副作用**：组件卸载时恢复状态

#### 自动关闭
```tsx
const handleMenuClick = () => {
  setIsOpen(false);
};
```

**特性**：
- 点击菜单项后自动关闭
- 点击遮罩层关闭
- 提供流畅的导航体验

## 技术特性

### 响应式设计
- **移动端专属**：`lg:hidden` 只在移动端显示
- **自适应宽度**：`w-80 max-w-[80vw]` 适配不同屏幕
- **触摸友好**：大按钮和合适的间距

### 动画效果
- **平滑过渡**：`transition-transform duration-300 ease-in-out`
- **毛玻璃遮罩**：`backdrop-blur-sm` 现代视觉效果
- **悬停反馈**：`hover:bg-base-200` 交互反馈

### 可访问性
- **ARIA 标签**：`aria-label` 和 `aria-hidden`
- **键盘支持**：ESC 键关闭
- **焦点管理**：合理的 tab 顺序

### 性能优化
- **条件渲染**：只在需要时渲染抽屉
- **事件清理**：防止内存泄漏
- **CSS 优化**：使用 transform 而非 position 动画

## 用户体验

### 移动端导航流程
1. 用户点击汉堡菜单按钮
2. 侧边栏从左侧滑出，背景变暗
3. 用户可以浏览导航菜单
4. 点击菜单项导航到对应页面，侧边栏自动关闭
5. 或点击关闭按钮/遮罩层/ESC键关闭侧边栏

### 视觉设计
- **一致性**：与应用整体设计风格保持一致
- **层次感**：通过阴影和遮罩营造深度
- **品牌感**：底部显示应用信息
- **现代感**：毛玻璃效果和平滑动画

## 兼容性

### 浏览器支持
- ✅ 现代移动浏览器
- ✅ iOS Safari
- ✅ Android Chrome
- ✅ 支持触摸和键盘操作

### 设备适配
- ✅ 手机（320px - 768px）
- ✅ 小平板（768px - 1024px）
- ✅ 自动隐藏在桌面端（1024px+）

## 状态
- [x] 顶部导航栏修改完成
- [x] MobileSidebar 组件创建完成
- [x] 汉堡菜单按钮实现完成
- [x] 侧边栏抽屉实现完成
- [x] 导航菜单集成完成
- [x] 键盘支持添加完成
- [x] 动画效果实现完成
- [ ] 浏览器效果验证

## 访问测试
开发服务器：http://localhost:3001/home

**测试重点**：
1. 移动端汉堡菜单按钮是否显示
2. 点击后侧边栏是否正确展开
3. 导航菜单是否正常工作
4. 关闭功能是否正常（按钮/遮罩/ESC键）
5. 动画效果是否流畅
6. 桌面端是否正常隐藏汉堡菜单
